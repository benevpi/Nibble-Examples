#include <CircuitOS.h>
#include <Nibble.h>

Display* display;
Sprite* sprite;

int position_x = 0;
int direction = 1;

const unsigned short face[0x100] ={
0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0xFEAA, 0xFECA, 0xFEEA, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,   // 0x0010 (16)
0x0000, 0x0000, 0x0000, 0x0000, 0xFDC8, 0xFE89, 0xFE89, 0xFE69, 0xFE69, 0xFE69, 0xFE8A, 0xFE89, 0xFD45, 0x0000, 0x0000, 0x0000,   // 0x0020 (32)
0x0000, 0x0000, 0x0000, 0xFE29, 0xFEA9, 0xFF0A, 0xFEAA, 0xFE89, 0xFE69, 0xFE89, 0xFECA, 0xFF0A, 0xFE89, 0xFE29, 0x0000, 0x0000,   // 0x0030 (48)
0x0000, 0x0000, 0xFE89, 0xFE89, 0xFECA, 0xFE49, 0xFE69, 0xFE69, 0xFE69, 0xFE69, 0xFE69, 0xFE69, 0xFEEA, 0xFE69, 0xFE49, 0x0000,   // 0x0040 (64)
0x0000, 0x0000, 0xFE49, 0xFEEA, 0xFE49, 0xFE69, 0xFE69, 0xFE69, 0xFE69, 0xFE69, 0xFE69, 0xFE69, 0xFE49, 0xFF0A, 0xFE49, 0x0000,   // 0x0050 (80)
0x0000, 0xFE49, 0xFEAA, 0xFE69, 0xFE69, 0xFE29, 0xFE69, 0xFE69, 0xFE69, 0xFE69, 0xFE69, 0xFE29, 0xFE69, 0xFE69, 0xFE89, 0xFE49,   // 0x0060 (96)
0x0000, 0xFE49, 0xFEEA, 0xFE8A, 0xEDC8, 0x6A40, 0xAC24, 0xFEAA, 0xFE69, 0xFEAA, 0xA3E4, 0x7261, 0xF608, 0xFE89, 0xFEEA, 0xFE49,   // 0x0070 (112)
0x0000, 0xFE69, 0xFECA, 0xFEAA, 0xCCE6, 0x4120, 0x82E1, 0xFE8A, 0xFE69, 0xFE89, 0x7AA1, 0x4940, 0xD547, 0xFEAA, 0xFEEA, 0xFE49,   // 0x0080 (128)
0x0000, 0xFE49, 0xFECA, 0xFE69, 0xF608, 0x82E2, 0xC4A5, 0xFEAA, 0xFE69, 0xFE8A, 0xB465, 0x8B02, 0xF629, 0xFE69, 0xFEEA, 0xFE49,   // 0x0090 (144)
0x0000, 0xFE49, 0xFEEA, 0xFE49, 0xFE69, 0xFECA, 0xFEEA, 0xFEAA, 0xFEAA, 0xFEAA, 0xFEEA, 0xFECA, 0xFE69, 0xFE49, 0xFEEA, 0xFE69,   // 0x00A0 (160)
0x0000, 0xFE69, 0xFECA, 0xFE69, 0xFE69, 0xC4A5, 0xAC24, 0xB424, 0xB424, 0xB424, 0xAC04, 0xC4C6, 0xFE69, 0xFE69, 0xFEAA, 0xFE49,   // 0x00B0 (176)
0x0000, 0xFFE0, 0xFE49, 0xFEEA, 0xFE69, 0xC4A5, 0xAC24, 0xB444, 0xB444, 0xB444, 0xAC24, 0xC4C6, 0xFE69, 0xFEEA, 0xFE49, 0x0000,   // 0x00C0 (192)
0x0000, 0x0000, 0xFE49, 0xFE89, 0xFECA, 0xFEAA, 0xFEAA, 0xFEAA, 0xFEAA, 0xFEAA, 0xFEAA, 0xFE8A, 0xFECA, 0xFE89, 0xFE49, 0x0000,   // 0x00D0 (208)
0x0000, 0x0000, 0x0000, 0xFE29, 0xFEAA, 0xFF0A, 0xFEAA, 0xFE69, 0xFE69, 0xFE69, 0xFEAA, 0xFF0A, 0xFE89, 0xFE49, 0x0000, 0x0000,   // 0x00E0 (224)
0x0000, 0x0000, 0x0000, 0x0000, 0xFDE9, 0xFE89, 0xFE89, 0xFE69, 0xFEAA, 0xFE69, 0xFE89, 0xFE89, 0xFDA9, 0x0000, 0x0000, 0x0000,   // 0x00F0 (240)
0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0xFDA9, 0xFECA, 0xFEA9, 0xFEA9, 0xFDE7, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,   // 0x0100 (256)
};

void setup() {
  Nibble.begin();
  display = Nibble.getDisplay();

  Serial.begin(115200);

  sprite = display->getBaseSprite();
  sprite->clear(TFT_BLACK);
	display->commit();

}

void loop() {
  sprite->clear(TFT_BLACK);
  sprite->drawIcon(face, position_x, 50, 16, 16, 1);
  display->commit();

  position_x += direction;

  if(position_x == (display->getWidth()-16) || position_x == 0) direction = direction * -1;

  delay(10);

}